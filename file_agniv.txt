This commit is from Agniv